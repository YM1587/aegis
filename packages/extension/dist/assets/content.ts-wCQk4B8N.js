(function(){console.log("Aegis content script loaded");function i(e){var s;const o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),n=[];let t;for(;t=o.nextNode();){const c=(s=t.textContent)==null?void 0:s.trim();c&&c.length>30&&t.parentElement&&n.push(t)}return n}async function a(e){var n;const o=(n=e.textContent)==null?void 0:n.trim();if(o)try{const t=await chrome.runtime.sendMessage({target:"offscreen",type:"ANALYZE_TEXT",data:{text:o}});t&&t.isToxic&&(console.log("Blocking toxic content:",o.substring(0,20)+"...",t.score),l(e.parentElement))}catch{}}function l(e){e.style.filter="blur(10px)",e.style.pointerEvents="none",e.setAttribute("data-aegis-blocked","true"),e.title="Content hidden by Aegis AI"}const r=async()=>{console.log("Aegis AI: Starting page scan...");const e=i(document.body);console.log(`Found ${e.length} text nodes to analyze.`);const o=3;for(let n=0;n<e.length;n+=o){const t=e.slice(n,n+o);await Promise.all(t.map(a)),await new Promise(s=>setTimeout(s,100))}};setTimeout(r,1e3);
})()
